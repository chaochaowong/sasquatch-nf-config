// Settings to run the atacseq workflow on sarthy_lab assoc on Sasquatch 
// Settings are set to run atacseq test

//global parameters
params {
    // association account on sasquatch
    assoc                      = 'sarthy_lab'
    partition                  = 'cpu-core-sponsored'
    account                    = 'cpu-sarthy_lab-sponsored'
    outdir                     = '/data/hps/assoc/private/sarthy_lab/user/cwo11/projects/atacseq_test'
    publish_dir_mode           = 'copy'

    // Input options
    input                      = 'https://raw.githubusercontent.com/nf-core/test-datasets/atacseq/samplesheet/v2.0/samplesheet_test.csv'
    fragment_size              = 200
    fingerprint_bins           = 500000
    read_length                = 150
    with_control               = false

    // config profile info   
    config_profile_name        = 'Test profile'
    config_profile_description = 'Minimal test dataset to check pipeline function'


    // Limit resources so that this can run on GitHub Actions
    max_cpus   = 8
    max_memory = '32.GB'
    max_time   = '24.h'

    // Genome references
    mito_name = 'MT'
    fasta     = 'https://raw.githubusercontent.com/nf-core/test-datasets/atacseq/reference/genome.fa'
    gtf       = 'https://raw.githubusercontent.com/nf-core/test-datasets/atacseq/reference/genes.gtf'

    // Options: Alignment
    aligner                    = 'bwa'
    bwa_min_score              = 30
    keep_mito                  = false
    keep_dups                  = false
    keep_multi_map             = false
    skip_merge_replicates      = false
    save_align_intermeds       = false
    save_unaligned             = false

    // Options: DESeq2 QC
    deseq2_vst                 = true
    skip_deseq2_qc             = false

    // Options: QC
    skip_qc                    = false
    skip_fastqc                = false
    skip_picard_metrics        = false
    skip_preseq                = true
    skip_plot_profile          = false
    skip_plot_fingerprint      = false
    skip_ataqv                 = false
    skip_igv                   = false
    skip_multiqc               = false

    // Options: Peaks
    narrow_peak                = false
    broad_cutoff               = 0.1
    macs_fdr                   = null
    macs_pvalue                = null
    min_reps_consensus         = 1
    save_macs_pileup           = false
    skip_peak_qc               = false
    skip_peak_annotation       = false
    skip_consensus_peaks       = false

}

workDir = "/data/hps/assoc/private/${params.assoc}/user/$USER/temp"

profiles {
    //For executing the jobs on Sasquatch clusterq
    sasquatch {
        process.executor       = 'slurm'
        process.queue          = "${params.partition}"
        process.clusterOptions = "--account=${params.account} --time=72:00:00"
        apptainer.enabled      = true
        apptainer.autoMounts   = true
        apptainer.cacheDir     = "$HOME/apptainer_test"
        // apptainer.cacheDir     = "/data/hps/assoc/private/${params.assoc}/user/$USER/apptainer"
        apptainer.runOptions   = '--containall --no-home'
        apptainer.pullTimeout  = '6h'
        conda.enabled          = false
        docker.enabled         = false
        singularity.enabled    = false
        podman.enabled         = false
        shifter.enabled        = false
        charliecloud.enabled   = false
    }
}

apptainer.registry   = 'quay.io'


